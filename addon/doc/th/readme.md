# ส่วนเสริม NVDA สำหรับเพิ่มประสิทธิภาพการเข้าถึง LINE Desktop

## ภาพรวม (Overview)

ส่วนเสริม (Add-on) นี้ช่วยเพิ่มประสิทธิภาพการทำงานของโปรแกรมอ่านหน้าจอ NVDA สำหรับแอปพลิเคชัน LINE บน Windows (เวอร์ชัน Qt6) โดยจะช่วยอำนวยความสะดวกในการนำทางห้องแชท การอ่านข้อความ และการโทรออกผ่านระบบ OCR และการสั่งการแบบระบุพิกัดอัตโนมัติ

> [!IMPORTANT]
> **ข้อควรทราบ**: ส่วนเสริมนี้มีการใช้เทคโนโลยี OCR (Optical Character Recognition) ในบางฟังก์ชัน ผลลัพธ์ที่ได้อาจไม่ถูกต้องแม่นยำ 100%

## คุณสมบัติเด่น (Features)

* **ปรับปรุงระบบการนำทาง**: สำหรับรายการแชทและช่องกรอกข้อความ
* **การโทรด้วยเสียงและวิดีโอ**: เริ่มการโทรจากแท็บเพื่อน
* **การจัดการสายเรียกเข้า**: รับสาย ปฏิเสธสาย หรือตรวจสอบข้อมูลผู้โทร
* **รองรับระบบ OCR**: พยายามอ่านข้อความที่ระบบการเข้าถึงมาตรฐาน (Accessibility APIs) เข้าไม่ถึงโดยอัตโนมัติ
* **เครื่องมือช่วยเหลือ (Debug Tools)**: มีคีย์ลัดสำหรับตรวจสอบโครงสร้าง UI เพื่อใช้ในการแก้ไขปัญหา

## คำแนะนำการใช้งาน (Usage Tips)

* **การสร้างการเชื่อมต่อ**: ก่อนจะใช้ส่วนเสริมนี้ส่งข้อความหาใครเป็นครั้งแรก แนะนำให้ส่งข้อความหาคนนั้นผ่านโทรศัพท์มือถือหรือ Chrome Extension ก่อนอย่างน้อยหนึ่งข้อความ เนื่องจากประวัติการแชทจะช่วยให้ส่วนเสริมค้นหาตำแหน่งขององค์ประกอบต่าง ๆ ได้แม่นยำยิ่งขึ้น
* **การส่งข้อความ**:
    1. ค้นหาชื่อเพื่อน โดยพยายามใช้คำค้นหาที่แสดงผลลัพธ์เพียงรายการเดียวเพื่อป้องกันความผิดพลาด
    2. เมื่ออยู่ในรายการแชทหรือแถบด้านข้าง ให้กด `Shift+Tab` เพื่อไปยังช่องพิมพ์ข้อความ (Edit field)
    3. พิมพ์ข้อความแล้วกด `Enter` เพื่อส่ง
* **การโทรออก**:
    ขณะนี้ไม่สามารถกดโทรออกได้โดยตรงจากแท็บแชทด้วยส่วนเสริมนี้ โปรดทำตามขั้นตอนต่อไปนี้:
    1. กด `Control+1` เพื่อสลับไปยังแท็บเพื่อน
    2. ค้นหาชื่อเพื่อน เลือกเพื่อน และเปิดห้องแชท
    3. กด `NVDA+Windows+C` เพื่อโทรด้วยเสียง หรือกด `NVDA+Windows+V` เพื่อโทรด้วยวิดีโอ
* **การตรวจสอบ**: ควรตรวจสอบประวัติการแชทและชื่อผู้รับให้แน่ใจทุกครั้งก่อนจะส่งข้อความหรือกดโทรออก

## คีย์ลัด (Keyboard Shortcuts)

| คีย์ลัด | หมวดหมู่ | คำสั่ง |
|---|---|---|
| **NVDA+Windows+C** | LINE Desktop | เริ่มการโทรด้วยเสียง (Voice Call) |
| **NVDA+Windows+V** | LINE Desktop | เริ่มการโทรด้วยวิดีโอ (Video Call) |
| **NVDA+Windows+A** | LINE Desktop | รับสายเรียกเข้า |
| **NVDA+Windows+D** | LINE Desktop | ปฏิเสธสายเรียกเข้า |
| **NVDA+Windows+S** | LINE Desktop | ตรวจสอบข้อมูลผู้โทร |
| **NVDA+Windows+T** | LINE Desktop | อ่านชื่อห้องแชทปัจจุบัน |
| **Control+1** | LINE Desktop | สลับไปยังแท็บเพื่อน |
| **Control+2** | LINE Desktop | สลับไปยังแท็บแชท |
| **Control+3** | LINE Desktop | สลับไปยังแท็บเพิ่มเพื่อน |
| **Control+O** | LINE Desktop | เปิดไฟล์ (หยุดส่วนเสริมชั่วคราวจนกว่าจะเลือกไฟล์เสร็จ) |
| **NVDA+Shift+K** | LINE Desktop | ตรวจสอบ UIA และ OCR (คัดลอกลงคลิปบอร์ด) |
| **NVDA+Shift+J** | Global (ทั่วไป) | รายงานข้อมูลแอปและกระบวนการ (Process) ที่โฟกัสอยู่ |

## ชุมชนและการสนับสนุน (Community & Support)

* **กลุ่มผู้ใช้ LINE (LINE User Group)**: [เข้าร่วมกลุ่ม](https://line.me/R/ti/g/BKQ2dZtTjx)
  ยินดีต้อนรับสู่เข้าร่วมกลุ่มเพื่อเสนอแนะฟีเจอร์ใหม่ แจ้งปัญหาการใช้งาน หรือร่วมพูดคุยกับทีมพัฒนา
* **รหัสต้นฉบับ (Source Code) และการติดตามปัญหา**: [GitHub Repository](https://github.com/keyang556/linedesktopnvda)
  หากมีข้อเสนอแนะหรือพบข้อบกพร่อง สามารถเปิด Issue ได้ และหากต้องการร่วมพัฒนา สามารถส่ง Pull Request ได้เสมอ
* **ติดต่อนักพัฒนา**: [ติดต่อผ่าน LINE](https://line.me/ti/p/3GigC88lAt)

## เวอร์ชันที่รองรับ (Supported Versions)

* LINE สำหรับ Windows (ทั้งเวอร์ชันปกติ และ Microsoft Store)
* NVDA เวอร์ชัน 2022.1 หรือใหม่กว่า
